class o{constructor(){this.gameState="menu",this.score=0,this.highScore=0,this.dog={y:150,velocity:0},this.obstacles=[],this.animationId=null,this.dogImage=null,this.logoImage=null,this.obstaclesImage=null,this.cloudsImage=null,this.assetsLoaded=!1,this.CANVAS_WIDTH=800,this.CANVAS_HEIGHT=600,this.DOG_SIZE=30,this.OBSTACLE_WIDTH=60,this.GAP_SIZE=150,this.GRAVITY=.6,this.JUMP_STRENGTH=-12,this.OBSTACLE_SPEED=3,this.gameLoop=()=>{this.updateGame(),this.draw(),this.animationId=requestAnimationFrame(this.gameLoop)},this.canvas=document.createElement("canvas"),this.canvas.width=this.CANVAS_WIDTH,this.canvas.height=this.CANVAS_HEIGHT,this.canvas.style.border="3px solid #2c3e50",this.canvas.style.borderRadius="10px",this.canvas.style.display="block",this.canvas.style.margin="20px auto",this.canvas.style.background="linear-gradient(to bottom, #87CEEB 0%, #98D8E8 100%)",this.canvas.style.cursor="pointer",this.canvas.style.boxShadow="0 8px 32px rgba(0,0,0,0.3)",this.ctx=this.canvas.getContext("2d");const t=localStorage.getItem("flappydog-highscore");t&&(this.highScore=parseInt(t,10)),this.canvas.addEventListener("click",()=>this.handleInput()),document.addEventListener("keydown",s=>{s.code==="Space"&&(s.preventDefault(),this.handleInput())}),document.body.innerHTML=`
            <div style="
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                font-family: 'Arial', sans-serif;
                margin: 0;
                padding: 20px;
                box-sizing: border-box;
            ">
                <div style="text-align: center;">
                    <div id="game-container"></div>
                    <p style="
                        color: white;
                        margin-top: 20px;
                        font-size: 16px;
                        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
                    ">Click or press SPACE to play</p>
                </div>
            </div>
        `,document.getElementById("game-container").appendChild(this.canvas),this.loadAssets(),console.log("FlappyDog initialized - loading assets...")}loadAssets(){const t=[{name:"dog",path:"/assets/dog.png"},{name:"logo",path:"/asset/logo.png"},{name:"obstacles",path:"/assets/obstacles.png"},{name:"clouds",path:"/assets/clouds.png"}];let s=0;const e=t.length,i=()=>{s++,s===e&&(this.assetsLoaded=!0,console.log("All assets loaded!"),this.gameLoop())};this.dogImage=new Image,this.dogImage.onload=i,this.dogImage.onerror=()=>{console.warn("Dog image failed to load"),i()},this.dogImage.src="/dog.png",this.logoImage=new Image,this.logoImage.onload=i,this.logoImage.onerror=()=>{console.warn("Logo image failed to load"),i()},this.logoImage.src="/logo.png",this.obstaclesImage=new Image,this.obstaclesImage.onload=i,this.obstaclesImage.onerror=()=>{console.warn("Obstacles image failed to load"),i()},this.obstaclesImage.src="/obstacles.png",this.cloudsImage=new Image,this.cloudsImage.onload=i,this.cloudsImage.onerror=()=>{console.warn("Clouds image failed to load"),i()},this.cloudsImage.src="/clouds.png",setTimeout(()=>{this.assetsLoaded||(console.log("Assets taking too long, starting anyway..."),this.assetsLoaded=!0,this.gameLoop())},3e3)}handleInput(){this.gameState==="menu"?this.startGame():this.gameState==="playing"?this.jump():this.gameState==="gameOver"&&this.resetGame()}startGame(){this.gameState="playing",this.score=0,this.dog={y:this.CANVAS_HEIGHT/2,velocity:0},this.obstacles=[],console.log("Game started")}jump(){this.dog.velocity=this.JUMP_STRENGTH}resetGame(){this.gameState="menu",this.dog={y:this.CANVAS_HEIGHT/2,velocity:0},this.obstacles=[],this.score=0}updateGame(){this.gameState==="playing"&&(this.dog.velocity+=this.GRAVITY,this.dog.y+=this.dog.velocity,this.obstacles.forEach(t=>{t.x-=this.OBSTACLE_SPEED,!t.passed&&t.x+this.OBSTACLE_WIDTH<100&&(t.passed=!0,this.score++,console.log("Score:",this.score))}),this.obstacles=this.obstacles.filter(t=>t.x>-this.OBSTACLE_WIDTH),(this.obstacles.length===0||this.obstacles[this.obstacles.length-1].x<this.CANVAS_WIDTH-300)&&this.obstacles.push({x:this.CANVAS_WIDTH,gapY:100+Math.random()*(this.CANVAS_HEIGHT-300),passed:!1}),this.checkCollisions()&&this.gameOver())}checkCollisions(){if(this.dog.y<=0||this.dog.y+this.DOG_SIZE>=this.CANVAS_HEIGHT)return!0;for(const t of this.obstacles)if(100+this.DOG_SIZE>t.x&&100<t.x+this.OBSTACLE_WIDTH&&(this.dog.y<t.gapY||this.dog.y+this.DOG_SIZE>t.gapY+this.GAP_SIZE))return!0;return!1}gameOver(){this.gameState="gameOver",this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("flappydog-highscore",this.highScore.toString()),console.log("New high score:",this.highScore))}draw(){if(!this.assetsLoaded){this.ctx.clearRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT);const t=this.ctx.createLinearGradient(0,0,0,this.CANVAS_HEIGHT);t.addColorStop(0,"#667eea"),t.addColorStop(1,"#764ba2"),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT),this.ctx.fillStyle="#ffffff",this.ctx.font="bold 32px Arial",this.ctx.textAlign="center",this.ctx.fillText("Loading FlappyDog...",this.CANVAS_WIDTH/2,this.CANVAS_HEIGHT/2);return}this.ctx.clearRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT),this.drawBackground(),this.gameState==="menu"?this.drawMenu():this.gameState==="playing"?this.drawGame():this.gameState==="gameOver"&&this.drawGameOver()}drawBackground(){const t=this.ctx.createLinearGradient(0,0,0,this.CANVAS_HEIGHT);if(t.addColorStop(0,"#87CEEB"),t.addColorStop(.7,"#98D8E8"),t.addColorStop(1,"#B0E0E6"),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT),this.cloudsImage){for(let s=0;s<3;s++){const e=Date.now()*.01*(s+1)%(this.CANVAS_WIDTH+100);this.ctx.globalAlpha=.6-s*.1,this.ctx.drawImage(this.cloudsImage,e-100,50+s*40,100,60),this.ctx.drawImage(this.cloudsImage,e+200,100+s*30,80,50),this.ctx.drawImage(this.cloudsImage,e+400,80+s*35,120,70)}this.ctx.globalAlpha=1}}drawMenu(){if(this.logoImage){const i=(this.CANVAS_WIDTH-300)/2,h=80;this.ctx.shadowColor="rgba(0, 0, 0, 0.3)",this.ctx.shadowBlur=10,this.ctx.shadowOffsetX=5,this.ctx.shadowOffsetY=5,this.ctx.drawImage(this.logoImage,i,h,300,120),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0}else this.ctx.fillStyle="#2c3e50",this.ctx.font="bold 48px Arial",this.ctx.textAlign="center",this.ctx.fillText("FlappyDog",this.CANVAS_WIDTH/2,150);this.ctx.fillStyle="#2c3e50",this.ctx.font="bold 24px Arial",this.ctx.textAlign="center",this.ctx.fillText("Click or Press Space to Start",this.CANVAS_WIDTH/2,280),this.ctx.fillStyle="#34495e",this.ctx.font="20px Arial",this.ctx.fillText(`Best Score: ${this.highScore}`,this.CANVAS_WIDTH/2,320);const t=400+Math.sin(Date.now()*.003)*10;this.drawDog(150,t),this.ctx.fillStyle="rgba(52, 152, 219, 0.8)",this.ctx.fillRect(this.CANVAS_WIDTH/2-100,360,200,50),this.ctx.strokeStyle="#2980b9",this.ctx.lineWidth=3,this.ctx.strokeRect(this.CANVAS_WIDTH/2-100,360,200,50),this.ctx.fillStyle="#ffffff",this.ctx.font="bold 20px Arial",this.ctx.fillText("PLAY",this.CANVAS_WIDTH/2,390)}drawGame(){this.obstacles.forEach(t=>this.drawObstacle(t)),this.drawDog(100,this.dog.y),this.ctx.fillStyle="#ffffff",this.ctx.font="bold 36px Arial",this.ctx.textAlign="left",this.ctx.strokeStyle="#2c3e50",this.ctx.lineWidth=4,this.ctx.strokeText(`${this.score}`,30,60),this.ctx.fillText(`${this.score}`,30,60),this.score>0&&(this.ctx.fillStyle="#f39c12",this.ctx.font="18px Arial",this.ctx.textAlign="right",this.ctx.fillText(`Best: ${this.highScore}`,this.CANVAS_WIDTH-20,30))}drawGameOver(){this.obstacles.forEach(e=>this.drawObstacle(e)),this.drawDog(100,this.dog.y);const t=this.ctx.createRadialGradient(this.CANVAS_WIDTH/2,this.CANVAS_HEIGHT/2,0,this.CANVAS_WIDTH/2,this.CANVAS_HEIGHT/2,this.CANVAS_WIDTH/2);t.addColorStop(0,"rgba(0, 0, 0, 0.8)"),t.addColorStop(1,"rgba(0, 0, 0, 0.9)"),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT),this.ctx.shadowColor="#e74c3c",this.ctx.shadowBlur=20,this.ctx.fillStyle="#ffffff",this.ctx.font="bold 48px Arial",this.ctx.textAlign="center",this.ctx.fillText("Game Over",this.CANVAS_WIDTH/2,180),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.score===this.highScore&&this.score>0&&(this.ctx.fillStyle="#f39c12",this.ctx.font="bold 24px Arial",this.ctx.fillText("NEW RECORD!",this.CANVAS_WIDTH/2,220)),this.ctx.fillStyle="#ffffff",this.ctx.font="32px Arial",this.ctx.fillText(`Score: ${this.score}`,this.CANVAS_WIDTH/2,260),this.ctx.fillStyle="#bdc3c7",this.ctx.font="24px Arial",this.ctx.fillText(`Best: ${this.highScore}`,this.CANVAS_WIDTH/2,290),this.ctx.fillStyle="rgba(46, 204, 113, 0.8)",this.ctx.fillRect(this.CANVAS_WIDTH/2-120,320,240,50),this.ctx.strokeStyle="#27ae60",this.ctx.lineWidth=3,this.ctx.strokeRect(this.CANVAS_WIDTH/2-120,320,240,50),this.ctx.fillStyle="#ffffff",this.ctx.font="bold 20px Arial",this.ctx.fillText("PLAY AGAIN",this.CANVAS_WIDTH/2,350)}drawDog(t,s){if(this.dogImage){const e=this.DOG_SIZE+20,i=this.DOG_SIZE+15;if(this.gameState==="playing"){this.ctx.save(),this.ctx.translate(t+e/2,s+i/2);const h=Math.max(-.5,Math.min(.5,this.dog.velocity*.05));this.ctx.rotate(h),this.ctx.drawImage(this.dogImage,-e/2,-i/2,e,i),this.ctx.restore()}else this.ctx.drawImage(this.dogImage,t,s,e,i)}else this.ctx.fillStyle="#D2B48C",this.ctx.fillRect(t,s,this.DOG_SIZE,this.DOG_SIZE),this.ctx.fillStyle="#DDB892",this.ctx.fillRect(t+10,s-10,25,25),this.ctx.fillStyle="#fff",this.ctx.fillRect(t+20,s-5,8,8),this.ctx.fillStyle="#000",this.ctx.fillRect(t+22,s-3,4,4),this.ctx.fillStyle="#000",this.ctx.fillRect(t+30,s+2,3,2),this.ctx.fillStyle="#D2B48C",this.ctx.fillRect(t-8,s+5,10,5)}drawObstacle(t){if(this.obstaclesImage&&this.obstaclesImage.complete)try{this.ctx.save(),this.ctx.translate(t.x+this.OBSTACLE_WIDTH/2,t.gapY),this.ctx.scale(1,-1),this.ctx.drawImage(this.obstaclesImage,-this.OBSTACLE_WIDTH/2,0,this.OBSTACLE_WIDTH,t.gapY),this.ctx.restore(),this.ctx.drawImage(this.obstaclesImage,t.x,t.gapY+this.GAP_SIZE,this.OBSTACLE_WIDTH,this.CANVAS_HEIGHT-t.gapY-this.GAP_SIZE);return}catch(s){console.warn("Error drawing obstacle image:",s)}this.ctx.fillStyle="#34495e",this.ctx.fillRect(t.x,0,this.OBSTACLE_WIDTH,t.gapY),this.ctx.fillRect(t.x,t.gapY+this.GAP_SIZE,this.OBSTACLE_WIDTH,this.CANVAS_HEIGHT-t.gapY-this.GAP_SIZE),this.ctx.fillStyle="#2c3e50",this.ctx.fillRect(t.x-5,t.gapY-25,this.OBSTACLE_WIDTH+10,25),this.ctx.fillRect(t.x-5,t.gapY+this.GAP_SIZE,this.OBSTACLE_WIDTH+10,25),this.ctx.strokeStyle="#1a252f",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(t.x+5,0),this.ctx.lineTo(t.x+5,t.gapY),this.ctx.moveTo(t.x+this.OBSTACLE_WIDTH-5,0),this.ctx.lineTo(t.x+this.OBSTACLE_WIDTH-5,t.gapY),this.ctx.stroke()}destroy(){this.animationId&&cancelAnimationFrame(this.animationId)}}export{o as S};
